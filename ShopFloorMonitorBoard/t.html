<!DOCTYPE html>
<html>
<head>
    <title>voice</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <style type="text/css">
        body {
            width: 640px;
        }

        #source {
            width: 600px;
            height: 300px;
            margin: 0 auto;
            border: 1px solid red;
        }

        #destinition {
            width: 600px;
            height: 300px;
            margin: 0 auto;
            border: 1px solid black;
        }

        #move-box {
            background-color: black;
            width: 80px;
            height: 80px;
            position: absolute;
            top: 0px;
            left: 0px;
        }
    </style>
</head>
<body>
    <input type="type" id="text" name="name" value="Shop Floor Monitor Board" />
    <button onclick="voice()">Voice</button>
    <!--<div id="source">
        <div id="move-box"></div>
    </div>
    <div id="destinition"></div>
    <script src="doc/hammer.min.js"></script>
    <script src="doc/jquery-1.11.3.js"></script>-->
    <div>
        <input type="text" id="ttsText" value="Shop Floor Monitor Board">
        <input type="button" id="tts_btn" onclick="doTTS()" value="播放">
    </div>
    <div id="bdtts_div_id">
        <audio id="tts_autio_id" autoplay="autoplay">
            <source id="tts_source_id" src="http://tts.baidu.com/text2audio?lan=zh&ie=UTF-8&spd=9&text=播报内容" type="audio/mpeg">
            <embed id="tts_embed_id" height="0" width="0" src="">
        </audio>
    </div>

    <script type="text/javascript">
        function voice() {
            var msg = new SpeechSynthesisUtterance(document.getElementById('text').value);
            msg.rate = 1;
            msg.volume = 8;
            msg.pitch = 1;
            msg.lang = 'en-US';
            window.speechSynthesis.speak(msg);

        }
        //获取相关CSS属性
        var getCss = function (o, key) {
            return o.currentStyle ? o.currentStyle[key] : document.defaultView.getComputedStyle(o, false)[key];
        };

        function drag(element) {
            //element.style.top = getCss(element,"top");
            //element.style.left = getCss(element,"left");
            //var hammer = new Hammer(element);//hammer实例
            //var x = 0;
            //var y = 0;
            //hammer.on('panstart',function(event){
            //    x = parseInt(element.style.left);
            //    y = parseInt(element.style.top);
            //});
            //hammer.on('panmove',function(event){
            //    element.style.top = y + event.deltaY + "px";
            //    element.style.left = x + event.deltaX + "px";
            //});
            //hammer.on('panend',function(event){

            //});

        }
        var myElement = document.getElementById("move-box");
//    drag(myElement);
    </script><script type="text/javascript">
    function doTTS() {
        var ttsDiv = document.getElementById('bdtts_div_id');
        var ttsAudio = document.getElementById('tts_autio_id');
        var ttsText = document.getElementById('ttsText').value;

        // 这样为什么替换不了播放内容
        /*var ssrcc = 'http://tts.baidu.com/text2audio?lan=zh&ie=UTF-8&spd=10&text='+ttsText;
        document.getElementById('tts_source_id').src=ssrcc;*/

        // 这样就可实现播放内容的替换了
        ttsDiv.removeChild(ttsAudio);
        var au1 = '<audio id="tts_autio_id" autoplay="autoplay">';
        var sss = '<source id="tts_source_id" src="http://tts.baidu.com/text2audio?lan=zh&ie=UTF-8&spd=9&text=' + ttsText + '" type="audio/mpeg">';
        var eee = '<embed id="tts_embed_id" height="0" width="0" src="">';
        var au2 = '</audio>';
        ttsDiv.innerHTML = au1 + sss + eee + au2;

        ttsAudio = document.getElementById('tts_autio_id');

        ttsAudio.play();
    }
</script>
</body>
</html>
